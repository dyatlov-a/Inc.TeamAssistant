<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TeamAssistUI docs</title>
    <base href="/" />
    <!--
    If you need to add <link> or <script> elements to include CSS
    or JavaScript files for canvas views of your Stories, 
    YOU SHOULD PLACE THEM HERE, not in the "index.html" file.
    -->
    <link rel="stylesheet" href="_content/Inc.TeamAssistant.WebUI/css/main.css" />
    <link href="_content/Inc.TeamAssistant.WebUI/leaflet/leaflet.css" rel="stylesheet"/>
    <link rel="stylesheet" href="Inc.TeamAssistant.Stories.styles.css" />
    <link rel="stylesheet" href="css/blazor-ui.css" />
</head>

<body>
    <div id="app">
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>

    <!--
    If you need to add <script> elements to include 
    JavaScript files for canvas views of your Stories, 
    YOU SHOULD PLACE THEM HERE, not in the "index.html" file.
    -->
    <script src="leaflet/leaflet.js"></script>
    <script src="_framework/blazor.webassembly.js" autostart="false"></script>
    <script>
        window.browserJsFunctions = {
            getTimezone: () => {
                return new Date().getTimezoneOffset();
            },
            changeUrl: url => {
                history.pushState(null, '', url);
            },
            scrollToTop: () => {
                document.documentElement.scrollTop = 0;
            },
            editableText: {
                get: element => {
                    return element.innerText
                },
                set: (element, value) => {
                    element.innerText = value;
                }
            },
            focusElement: element => {
                element.focus();
            },
            addClassToElement: (selector, className) => {
                let element = document.querySelector(selector);
                if (element) {
                    element.classList.add(className);
                }
            },
            addPageScrollObserver: (elementSelector, anchorSelector, modificatorClass) => {
                const anchor = document.querySelector(anchorSelector);
                const element = document.querySelector(elementSelector);
                const placeholder = document.querySelector(elementSelector + '_placeholder')

                const observer = new IntersectionObserver(es => {
                    es.forEach(e => {
                        if (e.isIntersecting)
                        {
                            element.classList.remove(modificatorClass);
                            placeholder.style.height = '0px';
                        }
                        else {
                            element.classList.add(modificatorClass);
                            placeholder.style.height = element.offsetHeight + 'px';
                        }
                    });
                }, { threshold: 0 });

                if (anchor && element && placeholder)
                    observer.observe(anchor);
            },
            addCleanStyleActionToPasteListener: element => {
                element.addEventListener("paste", function(e) {
                    e.preventDefault();

                    const text = e.clipboardData.getData("text/plain");
                    const selection = window.getSelection();
                    if (!selection.rangeCount) return;

                    const range = selection.getRangeAt(0);
                    range.deleteContents();

                    const textNode = document.createTextNode(text);
                    range.insertNode(textNode);

                    range.setStartAfter(textNode);
                    range.setEndAfter(textNode);
                    selection.removeAllRanges();
                    selection.addRange(range);
                });
            }
        };
        
        Blazor.start({
            environment: window.localStorage.getItem("current_culture")
        });
    </script>
</body>

</html>