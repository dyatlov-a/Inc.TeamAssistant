@inherits PersistentComponent<TelegramLoginViewModel>

@inject IUserService UserService

<p class="telegram-login__text">@ViewModel.LoginTelegramText</p>
<div class="telegram-login__actions">
    @if (ViewModel != TelegramLoginViewModel.Empty)
    {
        <script
            async
            src="https://telegram.org/js/telegram-widget.js?22"
            data-telegram-login="@ViewModel.BotUserName"
            data-size="large"
            data-userpic="false"
            data-auth-url="accounts/login-tg"
            data-request-access="write">
        </script>
    }
</div>

@code {
    protected override async Task<TelegramLoginViewModel> Initialize(Dictionary<string, string> resources)
    {
        var botContext = await UserService.GetAuthBotContext();

        return new TelegramLoginViewModel(
            resources[Messages.Constructor_LoginTelegramText],
            botContext.UserName);
    }
}